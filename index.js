"use strict";
var testConnection = require("promise-test-connection");
var waitfor = require("waitfor-promise");
var Promise = require("bluebird");
module.exports = function (options) {
    return new Promise(function (resolve, reject) {
        var opt;
        var def = {
            time: 5000,
            timeout: 40000,
            verbose: true
        };
        if (!options) {
            opt = def;
        }
        else {
            opt = options;
            if (!opt.time) {
                opt.time = def.time;
            }
            if (!opt.timeout) {
                opt.timeout = def.timeout;
            }
            if (!opt.verbose) {
                opt.verbose = def.verbose;
            }
        }
        waitfor.pre(testConnection, opt).then(function (answer) {
            resolve(answer);
        }).catch(function (err) {
            reject('timeout? ' + err);
        });
    });
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFPLGNBQWMsV0FBVyx5QkFBeUIsQ0FBQyxDQUFDO0FBQzNELElBQU8sT0FBTyxXQUFXLGlCQUFpQixDQUFDLENBQUM7QUFFNUMsSUFBWSxPQUFPLFdBQU0sVUFBVSxDQUFDLENBQUE7QUFVcEMsaUJBQVMsVUFBUyxPQUEwQjtJQUV4QyxNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsVUFBUyxPQUFPLEVBQUUsTUFBTTtRQUV2QyxJQUFJLEdBQUcsQ0FBQztRQUNSLElBQUksR0FBRyxHQUFxQjtZQUN4QixJQUFJLEVBQUUsSUFBSTtZQUNWLE9BQU8sRUFBRSxLQUFLO1lBQ2QsT0FBTyxFQUFFLElBQUk7U0FDaEIsQ0FBQTtRQUNELEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztZQUNYLEdBQUcsR0FBRyxHQUFHLENBQUE7UUFFYixDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixHQUFHLEdBQUcsT0FBTyxDQUFBO1lBRWIsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDWixHQUFHLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUM7WUFDeEIsQ0FBQztZQUNELEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQ2YsR0FBRyxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDO1lBQzlCLENBQUM7WUFDRCxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUNmLEdBQUcsQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQztZQUM5QixDQUFDO1FBQ0wsQ0FBQztRQUdELE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFTLE1BQU07WUFDakQsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBQ25CLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEdBQUc7WUFDakIsTUFBTSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsQ0FBQTtRQUM3QixDQUFDLENBQUMsQ0FBQTtJQUdOLENBQUMsQ0FBQyxDQUFBO0FBR04sQ0FBQyxDQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHRlc3RDb25uZWN0aW9uID0gcmVxdWlyZShcInByb21pc2UtdGVzdC1jb25uZWN0aW9uXCIpO1xuaW1wb3J0IHdhaXRmb3IgPSByZXF1aXJlKFwid2FpdGZvci1wcm9taXNlXCIpO1xuXG5pbXBvcnQgKiBhcyBQcm9taXNlIGZyb20gXCJibHVlYmlyZFwiO1xuXG5pbnRlcmZhY2UgSW9wdGlvbnRyeWNvbm5lY3Qge1xuICAgIFxuICAgICAgICAgICAgdGltZT86IG51bWJlcjtcbiAgICAgICAgICAgIHRpbWVvdXQ/OiBudW1iZXI7XG4gICAgICAgICAgICB2ZXJib3NlPzogYm9vbGVhbjtcbiAgICAgICAgXG59XG5cbmV4cG9ydCA9IGZ1bmN0aW9uKG9wdGlvbnM/OklvcHRpb250cnljb25uZWN0KSB7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgbGV0IG9wdDtcbiAgICAgICAgbGV0IGRlZjpJb3B0aW9udHJ5Y29ubmVjdCA9IHtcbiAgICAgICAgICAgIHRpbWU6IDUwMDAsXG4gICAgICAgICAgICB0aW1lb3V0OiA0MDAwMCxcbiAgICAgICAgICAgIHZlcmJvc2U6IHRydWVcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgICAgICAgIG9wdCA9IGRlZlxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvcHQgPSBvcHRpb25zXG5cbiAgICAgICAgICAgIGlmICghb3B0LnRpbWUpIHtcbiAgICAgICAgICAgICAgICBvcHQudGltZSA9IGRlZi50aW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFvcHQudGltZW91dCkge1xuICAgICAgICAgICAgICAgIG9wdC50aW1lb3V0ID0gZGVmLnRpbWVvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW9wdC52ZXJib3NlKSB7XG4gICAgICAgICAgICAgICAgb3B0LnZlcmJvc2UgPSBkZWYudmVyYm9zZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgd2FpdGZvci5wcmUodGVzdENvbm5lY3Rpb24sIG9wdCkudGhlbihmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgICAgIHJlc29sdmUoYW5zd2VyKVxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdCgndGltZW91dD8gJyArIGVycilcbiAgICAgICAgfSlcblxuXG4gICAgfSlcblxuXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
